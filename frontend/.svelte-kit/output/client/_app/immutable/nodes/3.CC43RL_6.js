import{a as p,f}from"../chunks/D8t6tpFo.js";import{s as t,e as W,a as w,$ as X,b as n,c as r,g as a,r as e,t as I}from"../chunks/BHAR4PZv.js";import{d as Z,s as v,e as $,a as tt}from"../chunks/BsxsctS-.js";import{i as j}from"../chunks/Cl2nnox4.js";import{r as et,b as rt,e as at,i as ot}from"../chunks/BHUO7-JO.js";import{h as dt}from"../chunks/Ccg5Ibm-.js";var st=f('<p class="text-red-800 text-sm"> </p>'),lt=f('<div class="max-w-sm bg-white border-2 border-brand-black rounded-lg p-6"><h2 class="font-semibold mb-3">Iniciar sesión</h2> <form class="space-y-3"><input type="password" placeholder="Clave de administrador" class="w-full border-2 border-brand-black rounded px-3 py-2 bg-white"/> <!> <button type="submit" class="w-full py-2 font-bold bg-brand-black text-brand-yellow rounded border-2 border-brand-black disabled:opacity-50"> </button></form></div>'),nt=f('<p class="text-red-800 text-sm mb-2"> </p>'),it=f('<p class="text-sm text-gray-600"> </p>'),bt=f('<tr><td class="border border-brand-black px-2 py-1"> </td><td class="border border-brand-black px-2 py-1"> </td><td class="border border-brand-black px-2 py-1 capitalize"> </td><td class="border border-brand-black px-2 py-1"> </td><td class="border border-brand-black px-2 py-1 text-right"> </td></tr>'),ct=f('<div class="overflow-x-auto"><table class="w-full text-sm border-collapse"><thead><tr class="bg-brand-yellow"><th class="border border-brand-black px-2 py-1 text-left">Nombre</th><th class="border border-brand-black px-2 py-1 text-left">Código</th><th class="border border-brand-black px-2 py-1 text-left">Rol</th><th class="border border-brand-black px-2 py-1 text-left">Invitante</th><th class="border border-brand-black px-2 py-1 text-right">Invitados</th></tr></thead><tbody></tbody></table></div>'),vt=f('<div class="bg-white border-2 border-brand-black rounded-lg p-4"><div class="flex items-center justify-between mb-4"><h2 class="font-semibold">Resumen de redes</h2> <button type="button" class="px-3 py-1 text-sm border border-brand-black rounded bg-brand-yellow hover:opacity-90">Actualizar</button></div> <!> <!></div>'),pt=f('<div class="max-w-4xl mx-auto px-4 py-8"><h1 class="text-2xl font-bold mb-4">Admin — Redes</h1> <!></div>');function yt(P){let C=w(""),i=w(""),u=w(!1),_=w(null),m=w(!1);const S="aliadosqr_admin_token";async function Q(){t(i,""),t(u,!0);try{const o=await fetch("/api/admin/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({secret:a(C)})}),d=await o.json();if(!o.ok){t(i,d.error??"Credenciales inválidas",!0);return}localStorage.setItem(S,d.token),t(m,!0),await E()}catch{t(i,"Error de conexión")}finally{t(u,!1)}}async function E(){const o=localStorage.getItem(S);if(!o){t(m,!1),t(_,null);return}t(u,!0),t(i,"");try{const d=await fetch("/api/admin/redes",{headers:{"x-admin-token":o}});if(d.status===401){localStorage.removeItem(S),t(m,!1),t(_,null),t(i,"Sesión expirada. Vuelve a iniciar sesión.");return}const b=await d.json();if(!d.ok){t(i,b.error??"No se pudo cargar la información",!0);return}t(_,b,!0),t(m,!0)}catch{t(i,"Error de conexión")}finally{t(u,!1)}}typeof window<"u"&&localStorage.getItem(S)&&(t(m,!0),E());var N=pt();dt("1jef3w8",o=>{W(()=>{X.title="Admin — Aliados QR"})});var V=n(r(N),2);{var Y=o=>{var d=lt(),b=n(r(d),2),h=r(b);et(h);var y=n(h,2);{var R=c=>{var s=st(),l=r(s,!0);e(s),I(()=>v(l,a(i))),p(c,s)};j(y,c=>{a(i)&&c(R)})}var g=n(y,2),A=r(g,!0);e(g),e(b),e(d),I(()=>{g.disabled=a(u),v(A,a(u)?"Entrando…":"Entrar")}),$("submit",b,c=>{c.preventDefault(),Q()}),rt(h,()=>a(C),c=>t(C,c)),p(o,d)},B=o=>{var d=vt(),b=r(d),h=n(r(b),2);e(b);var y=n(b,2);{var R=s=>{var l=nt(),x=r(l,!0);e(l),I(()=>v(x,a(i))),p(s,l)};j(y,s=>{a(i)&&s(R)})}var g=n(y,2);{var A=s=>{var l=it(),x=r(l,!0);e(l),I(()=>v(x,a(u)?"Cargando…":"Sin datos aún.")),p(s,l)},c=s=>{var l=ct(),x=r(l),D=n(r(x));at(D,21,()=>a(_),ot,(F,k)=>{var O=bt(),T=r(O),G=r(T,!0);e(T);var z=n(T),H=r(z,!0);e(z);var K=n(z),L=r(K,!0);e(K);var q=n(K),M=r(q,!0);e(q);var J=n(q),U=r(J,!0);e(J),e(O),I(()=>{v(G,a(k).nombreCompleto),v(H,a(k).codigo),v(L,a(k).rol),v(M,a(k).invitanteNombre??"—"),v(U,a(k).totalInvitados)}),p(F,O)}),e(D),e(x),e(l),p(s,l)};j(g,s=>{a(_)?s(c,!1):s(A)})}e(d),tt("click",h,E),p(o,d)};j(V,o=>{a(m)?o(B,!1):o(Y)})}e(N),p(P,N)}Z(["click"]);export{yt as component};
