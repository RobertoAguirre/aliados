import{a as f,f as g}from"../chunks/D8t6tpFo.js";import{C as Y,p as ue,d as me,f as ve,e as fe,$ as ge,c as n,g as t,r as l,u as w,a as J,n as Z,b as o,t as P,s as R,j as _e}from"../chunks/BHAR4PZv.js";import{d as xe,s as A,e as he,a as ye}from"../chunks/BsxsctS-.js";import{i as H}from"../chunks/Cl2nnox4.js";import{r as k,e as we,i as ke,b as C,s as Ce}from"../chunks/BHUO7-JO.js";import{h as Ee}from"../chunks/Ccg5Ibm-.js";import{L as Re,b as Ae}from"../chunks/4oVehXen.js";import{Q as Ne}from"../chunks/_DoowVny.js";function Ie(c,m,e){var d=c==null?"":""+c;return d===""?null:d}function Oe(c,m,e,d,b,i){var E=c.__className;if(Y||E!==e||E===void 0){var N=Ie(e);(!Y||N!==c.getAttribute("class"))&&(N==null?c.removeAttribute("class"):c.className=N),c.__className=e}return i}async function Me({params:c,url:m,fetch:e}){const d=c.codigo,b=m.searchParams.get("rol")??"unete";if(b!=="impulsa"&&b!=="unete")return{referente:null,codigo:d,rol:"unete"};const i=await e(`/api/referente/${d}`);return i.ok?{referente:await i.json(),codigo:d,rol:b}:{referente:null,codigo:d,rol:b}}const We=Object.freeze(Object.defineProperty({__proto__:null,load:Me},Symbol.toStringTag,{value:"Module"}));var Pe=g('<p class="text-center">Referente no encontrado.</p> <a href="/" class="block text-center mt-4 underline">Inicio</a>',1),Te=g('<div class="mx-auto mb-4 max-w-xs border-2 border-brand-black rounded-lg p-3 bg-white"><!></div> <p class="text-sm mb-4">Comparte tu QR o enlace para hacer crecer tu red:</p> <a class="inline-block py-2 px-4 bg-brand-blue text-white rounded font-medium"> </a> <button type="button" class="mt-3 inline-flex items-center gap-2 px-5 py-2 rounded-full bg-[#25D366] text-white font-semibold border-2 border-brand-black shadow-[3px_3px_0_0_#000] hover:opacity-90">COMPARTIR</button>',1),De=g('<p class="text-sm">Te has unido a la red.</p>'),je=g('<div class="bg-white rounded-lg border-2 border-brand-black p-6 text-center"><p class="font-bold text-lg mb-2">Usuario creado</p> <p class="text-sm mb-4"> </p> <!> <a href="/" class="block mt-6 underline">Volver al inicio</a></div>'),Se=g("<option> </option>"),$e=g('<p class="text-red-800 text-sm"> </p>'),Le=g('<div><h2 class="text-lg font-bold flex items-center gap-2 mb-6"><span class="w-8 h-8 rounded-full bg-brand-blue/20 flex items-center justify-center text-brand-blue">ðŸ‘¤</span> Datos de registro</h2> <p class="text-sm text-gray-700 mb-4"> </p> <form class="space-y-4"><label class="block"><span class="block text-sm font-medium mb-1">NOMBRE</span> <input type="text" required="" class="w-full border-2 border-brand-black rounded px-3 py-2 bg-white" placeholder="Nombre"/></label> <label class="block"><span class="block text-sm font-medium mb-1">APELLIDO PATERNO</span> <input type="text" required="" class="w-full border-2 border-brand-black rounded px-3 py-2 bg-white"/></label> <label class="block"><span class="block text-sm font-medium mb-1">APELLIDO MATERNO</span> <input type="text" required="" class="w-full border-2 border-brand-black rounded px-3 py-2 bg-white"/></label> <label class="block"><span class="block text-sm font-medium mb-1">TELÃ‰FONO</span> <input type="tel" required="" class="w-full border-2 border-brand-black rounded px-3 py-2 bg-white"/></label> <div><span class="block text-sm font-medium mb-1">FECHA DE NACIMIENTO</span> <div class="flex gap-2"><select class="flex-1 border-2 border-brand-black rounded px-2 py-2 bg-white"></select> <input type="number" min="1" max="31" class="w-16 border-2 border-brand-black rounded px-2 py-2 bg-white text-center"/> <input type="number" min="1920" max="2026" class="w-20 border-2 border-brand-black rounded px-2 py-2 bg-white text-center"/></div></div> <label class="block"><span class="block text-sm font-medium mb-1">DIRECCIÃ“N</span> <input type="text" required="" class="w-full border-2 border-brand-black rounded px-3 py-2 bg-white" placeholder="ESCRIBE AQUÃ TU DIRECCIÃ“N"/></label> <div class="rounded overflow-hidden border border-brand-black/30 h-48"><!></div> <!> <button type="submit" class="w-full py-3 font-bold bg-brand-black text-brand-yellow rounded border-2 border-brand-black hover:opacity-90 disabled:opacity-50"> </button></form></div>'),Qe=g('<div class="max-w-lg mx-auto px-4 py-6"><!></div>');function Ge(c,m){ue(m,!0);let e=me({nombre:"",apellidoPaterno:"",apellidoMaterno:"",telefono:"",mes:"01",dia:"1",anio:"1990",direccion:"",lat:null,lng:null}),d=J(!1),b=J(""),i=J(null);const E=w(()=>{var a;return(a=m.data)==null?void 0:a.referente}),N=w(()=>{var a;return((a=m.data)==null?void 0:a.codigo)??""}),V=w(()=>{var a;return((a=m.data)==null?void 0:a.rol)??"unete"}),T=w(()=>t(V)==="impulsa"),ee=w(()=>t(T)?"border-brand-orange":"border-[var(--color-brand-yellow)]"),re=w(()=>`${e.anio}-${e.mes.padStart(2,"0")}-${e.dia.padStart(2,"0")}`);async function ae(){R(b,""),R(d,!0);try{const a=await fetch("/api/usuarios",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nombre:e.nombre,apellidoPaterno:e.apellidoPaterno,apellidoMaterno:e.apellidoMaterno,telefono:e.telefono,fechaNacimiento:t(re),direccion:e.direccion,lat:e.lat,lng:e.lng,invitanteCodigo:t(N),rol:t(V)})}),s=await a.json();if(!a.ok){R(b,s.error??"Error al crear usuario",!0);return}R(i,s,!0)}catch(a){R(b,a.message??"Error de conexiÃ³n",!0)}finally{R(d,!1)}}function te(){if(!t(i)||!t(T))return;const a=`${window.location.origin}/r/${t(i).codigo}`,s=`ÃšNETE A MI RED
Red de ${t(i).nombreCompleto}
${a}`,u=`https://wa.me/?text=${encodeURIComponent(s)}`;window.open(u,"_blank")}var Q=Qe();Ee("3toirh",a=>{fe(()=>{ge.title="Datos de registro â€” Aliados QR"})});var oe=n(Q);{var le=a=>{var s=Pe();Z(2),f(a,s)},ne=a=>{var s=je(),u=o(n(s),2),U=n(u,!0);l(u);var I=o(u,2);{var O=p=>{var _=Te(),x=_e(_),j=n(x);{let $=w(()=>`/r/${t(i).codigo}`);Ne(j,{get path(){return t($)},size:220,alt:"QR de tu red"})}l(x);var v=o(x,4),S=n(v);l(v);var M=o(v,2);P(()=>{Ce(v,"href",`/r/${t(i).codigo??""}`),A(S,`/r/${t(i).codigo??""}`)}),ye("click",M,te),f(p,_)},D=p=>{var _=De();f(p,_)};H(I,p=>{t(T)?p(O):p(D,!1)})}Z(2),l(s),P(()=>A(U,t(i).nombreCompleto)),f(a,s)},se=a=>{var s=Le(),u=o(n(s),2),U=n(u);l(u);var I=o(u,2),O=n(I),D=o(n(O),2);k(D),l(O);var p=o(O,2),_=o(n(p),2);k(_),l(p);var x=o(p,2),j=o(n(x),2);k(j),l(x);var v=o(x,2),S=o(n(v),2);k(S),l(v);var M=o(v,2),$=o(n(M),2),L=n($);we(L,20,()=>["01","02","03","04","05","06","07","08","09","10","11","12"],ke,(r,h)=>{var y=Se(),be=n(y,!0);l(y);var X={};P(pe=>{A(be,pe),X!==(X=h)&&(y.value=(y.__value=h)??"")},[()=>["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"][parseInt(h)-1]]),f(r,y)}),l(L);var q=o(L,2);k(q);var W=o(q,2);k(W),l($),l(M);var z=o(M,2),G=o(n(z),2);k(G),l(z);var B=o(z,2),ie=n(B);Re(ie,{get lat(){return e.lat},set lat(r){e.lat=r},get lng(){return e.lng},set lng(r){e.lng=r}}),l(B);var K=o(B,2);{var de=r=>{var h=$e(),y=n(h,!0);l(h),P(()=>A(y,t(b))),f(r,h)};H(K,r=>{t(b)&&r(de)})}var F=o(K,2),ce=n(F,!0);l(F),l(I),l(s),P(()=>{Oe(s,1,`bg-white rounded-lg border-2 ${t(ee)??""} p-6 shadow-lg`),A(U,`Completa los datos obligatorios. Te registras ${t(T)?"como impulsor":"en la red"} de ${t(E).nombreCompleto??""}.`),F.disabled=t(d),A(ce,t(d)?"Creandoâ€¦":"CREAR USUARIO")}),he("submit",I,r=>{r.preventDefault(),ae()}),C(D,()=>e.nombre,r=>e.nombre=r),C(_,()=>e.apellidoPaterno,r=>e.apellidoPaterno=r),C(j,()=>e.apellidoMaterno,r=>e.apellidoMaterno=r),C(S,()=>e.telefono,r=>e.telefono=r),Ae(L,()=>e.mes,r=>e.mes=r),C(q,()=>e.dia,r=>e.dia=r),C(W,()=>e.anio,r=>e.anio=r),C(G,()=>e.direccion,r=>e.direccion=r),f(a,s)};H(oe,a=>{t(E)?t(i)?a(ne,1):a(se,!1):a(le)})}l(Q),f(c,Q),ve()}xe(["click"]);export{Ge as component,We as universal};
