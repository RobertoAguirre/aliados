import{a as m,f as v}from"../chunks/D8t6tpFo.js";import{p as S,t as h,g as e,f as X,e as Y,c as s,$ as Z,b as i,r as o,n as ee,s as n,a as $,u as ae}from"../chunks/BHAR4PZv.js";import{d as te,e as re,s as c,a as oe}from"../chunks/BsxsctS-.js";import{i as Q}from"../chunks/Cl2nnox4.js";import{b as se,r as ie,s as ne,e as de,i as le}from"../chunks/BHUO7-JO.js";import{h as ue}from"../chunks/Ccg5Ibm-.js";import{Q as ce}from"../chunks/_DoowVny.js";var pe=v('<p class="text-red-800 text-sm mb-4"> </p>'),be=v('<p class="text-sm text-gray-600">Aún no hay invitados. Comparte tu enlace o QR.</p>'),me=v('<li class="text-sm border-b border-gray-200 pb-2"> </li>'),ve=v('<ul class="space-y-2"></ul>'),fe=v('<div class="bg-white rounded-lg border-2 border-brand-black p-6"><p class="font-bold text-lg mb-1"> </p> <p class="text-sm text-gray-600 mb-4"> </p> <div class="mx-auto mb-4 max-w-xs border-2 border-brand-black rounded-lg p-3 bg-white"><!></div> <p class="text-sm font-medium mb-2">Tu enlace para invitar:</p> <a class="text-brand-blue underline break-all"> </a> <button type="button" class="mt-3 inline-flex items-center gap-2 px-5 py-2 rounded-full bg-[#25D366] text-white font-semibold border-2 border-brand-black shadow-[3px_3px_0_0_#000] hover:opacity-90">COMPARTIR</button> <h2 class="font-bold mt-6 mb-2"> </h2> <!></div>'),xe=v('<div class="max-w-lg mx-auto px-4 py-8"><h1 class="text-2xl font-bold text-center mb-2">Mi Red</h1> <p class="text-center text-sm mb-6">Ingresa tu código para ver el avance de tu red.</p> <form class="flex gap-2 mb-6"><input type="text" placeholder="Tu código (ej. ABC123)" maxlength="6" class="flex-1 border-2 border-brand-black rounded px-3 py-2 bg-white uppercase"/> <button type="submit" class="px-4 py-2 font-bold bg-brand-black text-brand-yellow rounded border-2 border-brand-black disabled:opacity-50"> </button></form> <!> <!> <a href="/" class="block mt-6 text-center underline text-sm">Volver al inicio</a></div>');function Re(P,T){S(T,!0);let y=$(""),x=$(!1),u=$(""),a=$(null);async function D(){const t=e(y).trim().toUpperCase();if(!t){n(u,"Ingresa tu código");return}n(u,""),n(x,!0),n(a,null);try{const r=await fetch(`/api/usuarios/by-codigo/${t}`);if(!r.ok){n(u,"Código no encontrado");return}const d=await r.json(),p=await fetch(`/api/usuarios/${d.id}/red`);if(!p.ok){n(u,"No se pudo cargar tu red");return}n(a,await p.json(),!0)}catch{n(u,"Error de conexión")}finally{n(x,!1)}}function U(){var b;if(!((b=e(a))!=null&&b.usuario))return;const t=`${window.location.origin}/r/${e(a).usuario.codigo}`,d=`ÚNETE A MI RED
Red de ${`${e(a).usuario.nombre} ${e(a).usuario.apellidoPaterno}`.trim()}
${t}`,p=`https://wa.me/?text=${encodeURIComponent(d)}`;window.open(p,"_blank")}var w=xe();ue("19cw1h1",t=>{Y(()=>{Z.title="Mi Red — Aliados QR"})});var g=i(s(w),4),k=s(g);ie(k);var R=i(k,2),N=s(R,!0);o(R),o(g);var j=i(g,2);{var V=t=>{var r=pe(),d=s(r,!0);o(r),h(()=>c(d,e(u))),m(t,r)};Q(j,t=>{e(u)&&t(V)})}var z=i(j,2);{var B=t=>{var r=fe(),d=s(r),p=s(d);o(d);var b=i(d,2),O=s(b);o(b);var C=i(b,2),W=s(C);{let l=ae(()=>`/r/${e(a).usuario.codigo}`);ce(W,{get path(){return e(l)},size:220,alt:"QR de tu red"})}o(C);var _=i(C,4),q=s(_);o(_);var E=i(_,2),A=i(E,2),F=s(A);o(A);var G=i(A,2);{var H=l=>{var f=be();m(l,f)},J=l=>{var f=ve();de(f,21,()=>e(a).invitados,le,(K,I)=>{var M=me(),L=s(M);o(M),h(()=>c(L,`${e(I).nombre??""} ${e(I).apellidoPaterno??""} — ${e(I).rol??""}`)),m(K,M)}),o(f),m(l,f)};Q(G,l=>{e(a).invitados.length===0?l(H):l(J,!1)})}o(r),h(()=>{c(p,`${e(a).usuario.nombre??""} ${e(a).usuario.apellidoPaterno??""} ${e(a).usuario.apellidoMaterno??""}`),c(O,`Código: ${e(a).usuario.codigo??""}`),ne(_,"href",`/r/${e(a).usuario.codigo??""}`),c(q,`/r/${e(a).usuario.codigo??""}`),c(F,`Invitados (${e(a).invitados.length??""})`)}),oe("click",E,U),m(t,r)};Q(z,t=>{e(a)&&t(B)})}ee(2),o(w),h(()=>{R.disabled=e(x),c(N,e(x)?"…":"Ver")}),re("submit",g,t=>{t.preventDefault(),D()}),se(k,()=>e(y),t=>n(y,t)),m(P,w),X()}te(["click"]);export{Re as component};
