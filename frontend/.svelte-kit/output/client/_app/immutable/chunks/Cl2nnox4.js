var x=Object.defineProperty;var R=a=>{throw TypeError(a)};var B=(a,e,t)=>e in a?x(a,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[e]=t;var w=(a,e,t)=>B(a,typeof e!="symbol"?e+"":e,t),E=(a,e,t)=>e.has(a)||R("Cannot "+t);var s=(a,e,t)=>(E(a,e,"read from private field"),t?t.call(a):e.get(a)),_=(a,e,t)=>e.has(a)?R("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,t),M=(a,e,t,i)=>(E(a,e,"write to private field"),i?i.call(a,t):e.set(a,t),t);import{M as S,W as C,X as A,Y,A as D,Z as F,C as T,J as N,_ as H,a0 as O,B as G,a1 as J,a2 as L,a3 as P,a4 as W,a5 as X,a6 as Z,I as j,G as I}from"./BHAR4PZv.js";var l,u,h,v,p,m,g;class q{constructor(e,t=!0){w(this,"anchor");_(this,l,new Map);_(this,u,new Map);_(this,h,new Map);_(this,v,new Set);_(this,p,!0);_(this,m,()=>{var e=S;if(s(this,l).has(e)){var t=s(this,l).get(e),i=s(this,u).get(t);if(i)C(i),s(this,v).delete(t);else{var n=s(this,h).get(t);n&&(s(this,u).set(t,n.effect),s(this,h).delete(t),n.fragment.lastChild.remove(),this.anchor.before(n.fragment),i=n.effect)}for(const[f,c]of s(this,l)){if(s(this,l).delete(f),f===e)break;const r=s(this,h).get(c);r&&(A(r.effect),s(this,h).delete(c))}for(const[f,c]of s(this,u)){if(f===t||s(this,v).has(f))continue;const r=()=>{if(Array.from(s(this,l).values()).includes(f)){var d=document.createDocumentFragment();H(c,d),d.append(D()),s(this,h).set(f,{effect:c,fragment:d})}else A(c);s(this,v).delete(f),s(this,u).delete(f)};s(this,p)||!i?(s(this,v).add(f),Y(c,r,!1)):r()}}});_(this,g,e=>{s(this,l).delete(e);const t=Array.from(s(this,l).values());for(const[i,n]of s(this,h))t.includes(i)||(A(n.effect),s(this,h).delete(i))});this.anchor=e,M(this,p,t)}ensure(e,t){var i=S,n=O();if(t&&!s(this,u).has(e)&&!s(this,h).has(e))if(n){var f=document.createDocumentFragment(),c=D();f.append(c),s(this,h).set(e,{effect:F(()=>t(c)),fragment:f})}else s(this,u).set(e,F(()=>t(this.anchor)));if(s(this,l).set(i,e),n){for(const[r,o]of s(this,u))r===e?i.unskip_effect(o):i.skip_effect(o);for(const[r,o]of s(this,h))r===e?i.unskip_effect(o.effect):i.skip_effect(o.effect);i.oncommit(s(this,m)),i.ondiscard(s(this,g))}else T&&(this.anchor=N),s(this,m).call(this)}}l=new WeakMap,u=new WeakMap,h=new WeakMap,v=new WeakMap,p=new WeakMap,m=new WeakMap,g=new WeakMap;function K(a,e,t=!1){var i;T&&(i=N,J());var n=new q(a),f=t?L:0;function c(r,o){if(T){var d=P(i),b;if(d===W?b=0:d===X?b=!1:b=parseInt(d.substring(1)),r!==b){var k=Z();j(k),n.anchor=k,I(!1),n.ensure(r,o),I(!0);return}}n.ensure(r,o)}G(()=>{var r=!1;e((o,d=0)=>{r=!0,c(d,o)}),r||c(!1,null)},f)}export{q as B,K as i};
